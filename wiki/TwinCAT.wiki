#summary TwinCAT ST Specs and Language Description

= TwinCAT ST (Structured Text) Language =

The structured text consists of a series of instructions which, as determined in high level languages, ("IF..THEN..ELSE") or in loops (WHILE..DO) can be executed.

== Expressions ==

Construction returning a value after its evaluation.
Composed of *operators* and *operands*.
An *operand* can be:
  * A constant
  * A variable
  * A function Call
  * An expression

{{{
expression = ( constant | variable | functioncall ),
             ( constant | variable | functioncall ) operator expression;
}}}

Binding strength in expressions:
  # Parentheses `(expression)`
  # Function call `Function name (parameter list)`
  # Exponentiation `EXPT`
  # Negate `NOT`
  # Multiply,Divide,Modulo `*,/,MOD`
  # Add,Subtract `+,-`
  # Compare `<,>,<=,>=`
  # Equal to,Not Equal to  `=,<>`
  # Boolean AND `AND`
  # Boolean XOR `XOR`
  # Boolean OR `OR`

== Instructions ==

There are several kind of instructions:
  * Assignment 
{{{
A:=B; CV := CV + 1; C:=SIN(X);
}}}
  * Calling a function block and use of the FB version 
{{{
CMD_TMR(IN := %IX5, PT := 300);
A:=CMD_TMR.Q;
}}}
  * Return from function 
{{{
RETURN;
}}}
  * If statement 
{{{
IF D<0.0  
THEN C:=A;
ELSIF D=0.0 
THEN C:=B;
ELSE C:=D;
END_IF;
}}}
  * Case statement
{{{
CASE INT1 OF 
1: BOOL1 := TRUE;
2: BOOL2 := TRUE;
ELSE 
BOOL1 := FALSE; 
BOOL2 := FALSE;
END_CASE;
}}}
  * For statement 
{{{
FOR I:=1 TO 100 BY 2 DO  
   IF ARR[I] = 70 
      THEN J:=I; 
      EXIT; 
   END_IF;
END_FOR;
}}}
  * While statement 
{{{
WHILE J<= 100 AND ARR[J] <> 70 DO  
   J:=J+2;
END_WHILE;
}}}
  * Repeat Until statement 
{{{
REPEAT J:=J+2; 
UNTIL J= 101 OR ARR[J] = 70
END_REPEAT;
}}}
  * Exit statement 
{{{
EXIT;
}}}
  * Empty instruction 
{{{
;
}}}

== Data Types ==

There are 2 groups of data types:
  * Standard Data Types
  * User Defined Data Types

=== Standard Data Types ===

  * BOOL {TRUE, FALSE}
  * BYTE {0 to 255}
  * WORD {0 to 65535}
  * DWORD {0 to 4294967295}
  * SINT {-128 to 127}
  * USINT {0 to 255}
  * INT {-32768 to 32767}
  * UINT {0 to 65535}
  * DINT {-2147483648 to 2147483647}
  * UDINT {0 to 4294967295}
  * LINT(n.s.)
  * ULINT(n.s.)
  * REAL {~ -3.402823 x 10^38 to ~ 3.402823 x 1038}
  * LREAL {~ -1.79769313486231E308 to ~ 1.79769313486232E308}
  * STRING {(dim) 'This is a String';}
  * TIME {T#0ms to T#71582m47s295ms}
  * TIME_OF_DAY (TOD) {TOD#00:00 to TOD#1193:02:47.295}
  * DATE {D#1970-01-01 to D#2106-02-06}
  * DATE_AND_TIME (DT) {DT#1970-01-01-00:00 to DT#2106-02-06-06:28:15}

=== User Defined Data Types ===

  * ARRAY (up to 3 dimensional)
{{{
<Field_Name>:ARRAY [<LowLim1>..<UpLim1>, *<LowLim2>..<UpLim2>, *<LowLim3>..<UpLim3>] OF <elem. Type>
}}}
  * POINTER (ADR() and SIZEOF() functions are needed; dereferenced by adding the content operator "^" after the pointer identifier)
{{{
<Identifier>: POINTER TO <Datatype/Functionblock>; 
}}}
  * ENUM
{{{
TYPE <Identifier>:(<Enum_0> ,<Enum_1>, ...,<Enum_n> *<assign>);END_TYPE
}}}
  * STRUCT (referenced using <Structurename>.<Componentname>)
{{{
TYPE <Structurename>:
STRUCT 
    <Declaration of Variables 1> 
    . 
    . 
    <Declaration of Variables n>
END_STRUCT
END_TYPE
}}}
  * ALIAS
{{{
TYPE <Identifier>: <Assignment term>;
END_TYPE
}}}
  * SUB-RANGE DATA TYPES (for defining a sub-range of a standard data type)
{{{
TYPE <Name> : <Inttype> (<ug>..<og>) END_TYPE; 
}}}